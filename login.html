<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Admin Login — AsiaTiger</title>
  <style>
    body { font-family: Arial; background: #f5f5f5; padding: 24px; }
    .box { max-width: 420px; margin: 60px auto; background: #fff; padding: 24px; border-radius: 8px; box-shadow: 0 1px 6px rgba(0,0,0,0.08); }
    label { font-weight: bold; display: block; margin-bottom: 6px; }
    input { width: 100%; padding: 10px; margin-bottom: 16px; border: 1px solid #ccc; border-radius: 6px; }
    button { width: 100%; padding: 12px; background: #007bff; color: #fff; border: none; border-radius: 6px; cursor: pointer; }
    .status { margin-top: 16px; text-align: center; font-size: 14px; color: #333; }
    .small { font-size: 13px; color: #666; margin-top: 8px; }
  </style>
</head>
<body>

<div class="box">
  <h2 style="text-align:center;">Admin Login</h2>

  <label>Email</label>
  <input id="email" type="text" placeholder="Enter email">

  <label>Password</label>
  <input id="password" type="password" placeholder="Enter password">

  <button id="loginBtn">Login</button>
  <div id="status" class="status">Status: —</div>
  <div class="small">This login is for admin only.</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { 
  getAuth, 
  signInWithEmailAndPassword 
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyDXGN7xdSPFW2Bj_W0WHauUabpcWQKtYKM",
  authDomain: "asiatiger-c41d3.firebaseapp.com"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

const statusBox = document.getElementById('status');

document.getElementById('loginBtn').addEventListener('click', async () => {
  const email = document.getElementById('email').value.trim();
  const pass = document.getElementById('password').value;

  if (!email || !pass) { 
    statusBox.textContent = "Status: Enter email & password"; 
    return; 
  }

  statusBox.textContent = "Status: Signing in...";

  try {
    const result = await signInWithEmailAndPassword(auth, email, pass);

    // Admin claim check
    const token = await result.user.getIdTokenResult(true);

    if (token.claims.admin === true) {
      statusBox.textContent = "Status: Login success!";
      window.location.href = "admin.html";
    } else {
      statusBox.textContent = "❌ You are not an admin";
    }

  } catch (e) {
    console.error(e);
    if (e.code === 'auth/user-not-found') {
      statusBox.textContent = "Status: User not found";
    } else if (e.code === 'auth/wrong-password') {
      statusBox.textContent = "Status: Wrong password";
    } else {
      statusBox.textContent = "Status: Login failed";
    }
  }
});
</script>

</body>
</html>
